var $=Object.defineProperty,V=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var x=(r,e,t)=>e in r?$(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,f=(r,e)=>{for(var t in e||(e={}))G.call(e,t)&&x(r,t,e[t]);if(v)for(var t of v(e))J.call(e,t)&&x(r,t,e[t]);return r},S=(r,e)=>V(r,Z(e));var R=(r,e)=>{if(Object.keys(e).length!==1)throw new Error("Too many or too few positions specified.");let n="beforeend",s;return"after"in e?(n="afterend",s=e.after):"before"in e?(n="beforebegin",s=e.before):("into"in e&&e.at==="start"&&(n="afterbegin"),s=e.into),s.insertAdjacentElement(n,r),r},w=r=>globalThis.addEventListener("DOMContentLoaded",r),_=({selector:r,all:e,from:t})=>(t!=null||(t=document),e?Array.from(t.querySelectorAll(r)):[t.querySelector(r)]),M=r=>r.remove(),j=r=>{r.innerHTML=""};var p=r=>r?r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):"",D=r=>{if(!r)return"";let e=/&(?:amp|lt|gt|quot|#(0+)?39);/g,t={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};return r.replace(e,n=>t[n]||"'")},P=(...r)=>{let e=0,t=r[0],n=1;typeof r[1]!="undefined"&&(e=r[0],t=r[1]),r[2]&&(n=r[2]);let s=[];for(let i=e;i<t;i+=n)s.push(i);return s};var Q=r=>document.createElement(r),U=r=>{var n;let e=r?r.match(/([0-9a-zA-Z\-]*)?(#[0-9a-zA-Z\-]*)?((.[0-9a-zA-Z\-]+)*)/):void 0,t=e?(n=e.slice(1,4))==null?void 0:n.map(s=>s?s.trim():void 0):Array(3).fill(void 0);return t&&t[1]&&(t[1]=t[1].replace(/#*/g,"")),e?{tag:t[0]||void 0,id:t[1]||void 0,classes:t[2]?t[2].split(".").filter(s=>s.trim()):void 0}:{}},h=class{constructor(e,t){this.props={};t&&(this.props=t),this.info=e}done(){let{tag:e,id:t,classes:n=[]}=U(this.info);if(n!=null&&n.some(i=>i.includes("#")))throw new Error("Error: Found # in a class name. Did you mean to do elt#id.classes instead of elt.classes#id?");e||(e="div");let s=Q(e);return t&&(s.id=t),n.forEach(i=>s.classList.add(i)),g(s,this.props)}content(e){return this.props.contents=e,this}attr(e,t){var n;return(n=this.props).attrs||(n.attrs={}),this.props.attrs[e]=t.toString(),this}attrs(e){return this.props.attrs=e,this}raw(e){return this.props.raw=e,this}misc(e,t){var n;return(n=this.props).misc||(n.misc={}),typeof e=="object"?this.props.misc=e:this.props.misc[e]=t,this}style(e,t){var n;return(n=this.props).style||(n.style={}),this.props.style[e]=t,this}styles(e){return this.props.style=e,this}on(e,t){var n;return(n=this.props).on||(n.on={}),this.props.on[e]=t,this}gimme(e){var t;return(t=this.props).gimme||(t.gimme=[]),Array.isArray(e)?this.props.gimme=e:this.props.gimme.push(e),this}};var H=r=>{let e={};for(let t in r)e[t]=r[t].value;return e},W=r=>!(!r||typeof r!="function"),g=(r,e={})=>{let{contents:t,misc:n,style:s,on:i={},attrs:C={},raw:N,gimme:F=[],deps:d={}}=e,u="";W(t)?(Object.entries(d).forEach(([l,z])=>{z.any(B=>{let T=t(H(d),{event:S(f({},B),{triggeredBy:l}),elt:r});T!==void 0&&(r.innerHTML=T)})}),u=t(H(d),{elt:r})||""):typeof t=="string"&&(u=t),u!=null&&u.trim()&&(r.innerHTML=N?u:p(u));let y=Object.values(d).map(a=>a.id);y.length&&r.setAttribute("data-cf-deps",y.join(",")),n&&Object.assign(r,n),s&&Object.assign(r.style,s),Object.entries(i).forEach(([a,l])=>r.addEventListener(a,l)),Object.entries(C).forEach(([a,l])=>r.setAttribute(a,l));let b=[];for(let a of F){let l=r.querySelector(a);b.push(l)}return[r,...b]},O=(r,e)=>new h(r,e);var L=new Set,A=()=>"cf-"+Math.random().toString(36).slice(2,8),X=()=>{let r=A();for(;L.has(r);)r=A();return L.add(r),r},o=class{constructor(e){this.id=X();this._subscribers={};this._subscriberCounts={};this._dead=!1;e&&(this.value=e)}on(e,t,n=!1){var s,i;return this._subscriberCounts[e]=this._subscriberCounts[e]||0,(i=(s=this._subscribers)[e])!=null||(s[e]={}),this._subscribers[e][this._subscriberCounts[e]]=t,n&&!["push","remove","mutation","setAt"].includes(e)&&t({type:"change",value:this.value}),this._subscriberCounts[e]++}any(e){this.on("append",e),this.on("change",e),this.on("clear",e),this.on("deletion",e)}unsubscribe(e,t){var n;(n=this._subscribers[e])==null||delete n[t]}update(e){this._dead||(this.value=e,this._sendEvent({type:"change",value:e}))}_sendEvent(e){if(this._dead)return;this._subscribers[e.type]=this._subscribers[e.type]||{};let t=this._subscribers[e.type];if(t)for(let n in Object.keys(t))t[n](e)}dispose(){this._dead=!0,this._subscribers={},this._subscriberCounts={}}};var c=class extends o{constructor(e){super(e)}clear(){this.value=[],this._sendEvent({type:"clear"})}push(e){return this.value.push(e),this._sendEvent({type:"append",value:e,idx:this.value.length-1}),this.value.length}remove(e){if(e<0||e>=this.value.length)throw new RangeError("Invalid index.");this._sendEvent({type:"deletion",idx:e,value:this.value.splice(e,1)[0]})}get(e){if(e<0||e>=this.value.length)throw new RangeError("Invalid index.");return this.value[e]}set(e,t){if(e<0||e>=this.value.length)throw new RangeError("Invalid index.");this.value[e]=t,this._sendEvent({type:"change",value:t,idx:e})}get length(){return this.value.length}};var m=class extends o{constructor(e){super(new Map);for(let[t,n]of Object.entries(e||{}))this.value.set(t,n)}set(e,t){this.value.set(e,t),this._sendEvent({key:e,value:t,type:"change"})}update(){}remove(e){this.value.delete(e),this._sendEvent({key:e,value:this.value,type:"deletion"})}clear(){this.value=new Map,this._sendEvent({type:"clear"})}transform(e,t){let n=this.value.get(e);if(!n)throw new Error(`ERROR: key ${e} does not exist in store!`);let s=t(n);this.set(e,s),this._sendEvent({type:"change",value:s,key:e})}get(e){return this.value.get(e)}has(e){return this.value.has(e)}entries(){return this.value.entries()}};function I(r){if("type"in r){if(r.type==="list")return new c(r.value);if(r.type==="map")return new m(r.value)}return new o(r.value)}var k=(r,e)=>{var t;return{raw:!0,contents:Array.isArray(r)?r.join((t=e==null?void 0:e.joiner)!=null?t:" "):r.toString()}},q=(r,...e)=>{let t=[];for(let n=0;n<r.length;n++){t.push(r[n]||"");let s=e[n];typeof s!="undefined"&&typeof s!="object"?t.push(p((s||"").toString())):t.push((s==null?void 0:s.contents)||"")}return t.join("")};var Y=(r,e={})=>{let t=new RegExp("\\\\({{\\s*"+Object.keys(e).join("|")+"\\s*}})","gi");return new RegExp(Object.keys(e).join("|"),"gi"),r.replace(new RegExp("(^|[^\\\\]){{\\s*("+Object.keys(e).join("|")+")\\s*}}","gi"),function(n,s,i){return`${s||""}${e[i]}`}).replace(t,"$1")},E=(r,e={},t=!0)=>{let n=f({},e);return t&&(n=Object.fromEntries(Object.entries(n).map(([s,i])=>[s,p(i)]))),Y(r,n)},K=(r,e=!0)=>t=>E(r,t,e);var De={ListStore:c,MapStore:m,Store:o,store:I,nu:O,mustache:E,template:K,escape:p,unescape:D,extend:g,insert:R,empty:j,rm:M,select:_,onload:w,html:q,r:k,seq:P};export{c as ListStore,m as MapStore,o as Store,De as default,j as empty,p as escape,g as extend,q as html,R as insert,E as mustache,O as nu,w as onload,k as r,M as rm,_ as select,P as seq,I as store,K as template,D as unescape};
