var w=(t,e)=>{if(!("into"in e)&&!("after"in e)&&!("before"in e))throw new Error("No valid position specified. Use 'into', 'after', or 'before'.");let r="beforeend",n;"after"in e?(r="afterend",n=e.after):"before"in e?(r="beforebegin",n=e.before):("into"in e&&e.at==="start"&&(r="afterbegin"),n=e.into);let s=document.createDocumentFragment();if(Array.isArray(t))for(let i of t)s.appendChild(i);else s.appendChild(t);return r==="beforebegin"?n.parentNode?.insertBefore(s,n):r==="afterend"?n.parentNode?.insertBefore(s,n.nextSibling):r==="afterbegin"?n.insertBefore(s,n.firstChild):n.appendChild(s),t},R=t=>globalThis.addEventListener("DOMContentLoaded",t),b=({s:t,all:e,from:r})=>(r??(r=document),e?Array.from(r.querySelectorAll(t)):[r.querySelector(t)]),M=t=>t.remove(),D=t=>{t.innerHTML=""};var l=t=>t?t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):"",H=t=>{if(!t)return"";let e=/&(?:amp|lt|gt|quot|#(0+)?39);/g,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"};return t.replace(e,n=>r[n]||"'")},L=(...t)=>{let e=0,r=t[0],n=1;typeof t[1]<"u"&&(e=t[0],r=t[1]),t[2]&&(n=t[2]);let s=[];for(let i=e;i<r;i+=n)s.push(i);return s},A=t=>{let e=["<"];return e.push(t.tagName.toLowerCase()),t.id&&e.push(`#${t.id}`),t.className.trim()&&e.push(`.${t.className.split(" ").join(".")}`),e.push(...Array.from(t.attributes).map(r=>`${r.name}="${r.value}"`).slice(0,3).join(" ")),e.join("")},O=()=>{let t=new MutationObserver(e=>{for(let r of e)r.addedNodes.forEach(n=>{if(!(n instanceof HTMLElement))return;let s=r.target;if(!s.hasAttribute("data-cf-deps")||s.hasAttribute("data-cf-fg-updates"))return;let i=n.querySelectorAll?.("[data-cf-deps]").length??0;!n.hasAttribute?.("data-cf-deps")&&i===0||console.warn(`[Campfire] \u26A0\uFE0F A reactive node ${A(n)} was inserted into a reactive container ${A(s)} This may cause it to be wiped on re-render.`)})});document.body.hasAttribute("cf-disable-mo")||t.observe(document.body,{childList:!0,subtree:!0})};var U=t=>document.createElement(t),Z=t=>{let e=t?t.match(/([0-9a-zA-Z\-]*)?(#[0-9a-zA-Z\-]*)?((.[0-9a-zA-Z\-]+)*)/):void 0,r=e?e.slice(1,4)?.map(n=>n?n.trim():void 0):Array(3).fill(void 0);return r&&r[1]&&(r[1]=r[1].replace(/#*/g,"")),e?{tag:r[0]||void 0,id:r[1]||void 0,classes:r[2]?r[2].split(".").filter(n=>n.trim()):void 0}:{}},E=class{constructor(e,r){this.props={};r&&(this.props=r),this.info=e}done(){let{tag:e,id:r,classes:n=[]}=Z(this.info);if(n?.some(i=>i.includes("#")))throw new Error("Error: Found # in a class name. Did you mean to do elt#id.classes instead of elt.classes#id?");e||(e="div");let s=U(e);return r&&(s.id=r),n.forEach(i=>s.classList.add(i)),y(s,this.props)}content(e){return this.props.contents=e,this}attr(e,r){var n;return(n=this.props).attrs||(n.attrs={}),this.props.attrs[e]=r.toString(),this}attrs(e){return this.props.attrs=e,this}raw(e){return this.props.raw=e,this}misc(e,r){var n;return(n=this.props).misc||(n.misc={}),typeof e=="object"?this.props.misc=e:this.props.misc[e]=r,this}style(e,r){var n;return(n=this.props).style||(n.style={}),this.props.style[e]=r,this}styles(e){return this.props.style=e??{},this}on(e,r){var n;return(n=this.props).on||(n.on={}),this.props.on[e]=r,this}gimme(...e){var r;return(r=this.props).gimme||(r.gimme=[]),this.props.gimme=e,this}deps(e){return this.props.deps={...this.props.deps,...e},this}html(e){return this.content(e).raw(!0)}children(e){return this.props.children=e,this}};"MutationObserver"in globalThis?O():console.warn("MutationObserver was not found in your browser. Campfire will","not be able to warn you of destructive mutations!");var _=t=>{let e={};for(let r in t){let n=t[r].value;n instanceof Map?e[r]=Object.fromEntries(n.entries()):e[r]=n.valueOf()}return e},W=t=>!(!t||typeof t!="function"),y=(t,e={})=>{let{contents:r,misc:n,style:s,on:i={},attrs:$={},raw:k,gimme:F=[],deps:h={},children:T={}}=e,m="";if(W(r)){Object.entries(h).forEach(([a,d])=>{d.any(f=>{let x=r(_(h),{event:{...f,triggeredBy:a},elt:t});if(x!==void 0){let K=b({s:"[data-cf-slot]",all:!0,from:t}).map(g=>[g.getAttribute("data-cf-slot"),g]);t.innerHTML=x,K.forEach(([g,z])=>{t.querySelector(`cf-slot[name='${g}']`)?.replaceWith(z)})}})});let o=r(_(h),{elt:t});typeof o>"u"?t.setAttribute("data-cf-fg-updates","true"):t.removeAttribute("data-cf-fg-updates"),m=o||""}else typeof r=="string"&&(m=r);m?.trim()&&(t.innerHTML=k?m:l(m),t.querySelectorAll("cf-slot[name]").forEach(o=>{let a=o.getAttribute("name");if(a&&a in T){let d=T[a],[f]=Array.isArray(d)?d:[d];if(!f)return;o.replaceWith(f),f.setAttribute("data-cf-slot",a)}})),Object.values(h).map(o=>o.id).length?t.setAttribute("data-cf-reactive","true"):t.removeAttribute("data-cf-reactive"),n&&Object.assign(t,n),s&&Object.assign(t.style,s),Object.entries(i).forEach(([o,a])=>t.addEventListener(o,a)),Object.entries($).forEach(([o,a])=>t.setAttribute(o,String(a)));let S=[];for(let o of F){let a=t.querySelector(o);S.push(a)}return[t,...S]},j=(t="div",e={})=>new E(t,e);var P=new Set,N=()=>"cf-"+Math.random().toString(36).slice(2,8),V=()=>{let t=N();for(;P.has(t);)t=N();return P.add(t),t},u=class{constructor(e){this.id=V();this._subscribers={};this._subscriberCounts={};this._dead=!1;typeof e<"u"&&e!==null&&(this.value=e)}on(e,r,n=!1){var s;return this._subscriberCounts[e]=this._subscriberCounts[e]||0,(s=this._subscribers)[e]??(s[e]={}),this._subscribers[e][this._subscriberCounts[e]]=r,n&&!["push","remove","mutation","setAt"].includes(e)&&r({type:"change",value:this.value}),this._subscriberCounts[e]++}any(e){this.on("append",e),this.on("change",e),this.on("clear",e),this.on("deletion",e)}unsubscribe(e,r){delete this._subscribers[e]?.[r]}update(e){this._dead||(this.value=e,this._sendEvent({type:"change",value:e}))}_sendEvent(e){if(this._dead)return;this._subscribers[e.type]=this._subscribers[e.type]||{};let r=this._subscribers[e.type];if(r)for(let n in Object.keys(r))r[n](e)}dispose(){this._dead=!0,this._subscribers={},this._subscriberCounts={}}valueOf(){return structuredClone(this.value)}};var p=class extends u{constructor(e){super(e)}clear(){this.value=[],this._sendEvent({type:"clear"})}push(e){return this.value.push(e),this._sendEvent({type:"append",value:e,idx:this.value.length-1}),this.value.length}remove(e){if(e<0||e>=this.value.length)throw new RangeError("Invalid index.");this._sendEvent({type:"deletion",idx:e,value:this.value.splice(e,1)[0]})}get(e){if(e<0||e>=this.value.length)throw new RangeError("Invalid index.");return this.value[e]}set(e,r){if(e<0||e>=this.value.length)throw new RangeError("Invalid index.");this.value[e]=r,this._sendEvent({type:"change",value:r,idx:e})}get length(){return this.value.length}};var c=class extends u{constructor(e){super(new Map);for(let[r,n]of Object.entries(e||{}))this.value.set(r,n)}set(e,r){this.value.set(e,r),this._sendEvent({key:e,value:r,type:"change"})}update(){}remove(e){this.value.delete(e),this._sendEvent({key:e,value:this.value,type:"deletion"})}clear(){this.value=new Map,this._sendEvent({type:"clear"})}transform(e,r){let n=this.value.get(e);if(!n)throw new Error(`ERROR: key ${e} does not exist in store!`);let s=r(n);this.set(e,s),this._sendEvent({type:"change",value:s,key:e})}get(e){return this.value.get(e)}has(e){return this.value.has(e)}entries(){return this.value.entries()}};function C(t){if("type"in t){if(t.type==="list")return new p(t.value);if(t.type==="map")return new c(t.value)}return new u(t.value)}var I=(t,e)=>({raw:!0,contents:Array.isArray(t)?t.join(e?.joiner??" "):t.toString()}),B=(t,...e)=>{let r=[];for(let n=0;n<t.length;n++){r.push(t[n]||"");let s=e[n];typeof s<"u"&&typeof s!="object"?r.push(l((s||"").toString())):r.push(s?.contents||"")}return r.join("")};var G=(t,e={})=>{let r=new RegExp("\\\\({{\\s*"+Object.keys(e).join("|")+"\\s*}})","gi");return new RegExp(Object.keys(e).join("|"),"gi"),t.replace(new RegExp("(^|[^\\\\]){{\\s*("+Object.keys(e).join("|")+")\\s*}}","gi"),function(n,s,i){return`${s||""}${e[i]}`}).replace(r,"$1")},v=(t,e={},r=!0)=>{let n={...e};return r&&(n=Object.fromEntries(Object.entries(n).map(([s,i])=>[s,l(i)]))),G(t,n)},q=(t,e=!0)=>r=>v(t,r,e);var we={ListStore:p,MapStore:c,Store:u,store:C,nu:j,mustache:v,template:q,escape:l,unescape:H,extend:y,insert:w,empty:D,rm:M,select:b,onload:R,html:B,r:I,seq:L};export{p as ListStore,c as MapStore,u as Store,we as default,D as empty,l as escape,y as extend,B as html,w as insert,v as mustache,j as nu,R as onload,I as r,M as rm,b as select,L as seq,C as store,q as template,H as unescape};
//# sourceMappingURL=campfire.esm.min.js.map
